# BIOS 启动固件

CPU执行的第一条指令

```
CS:IP = 0xf000:fff0
PC = 16*CS+IP
```

- 基本输入输出

- 系统配置信息
- 开机自检程序
- 系统自启动程序

BIOS

- 将加载程序从磁盘的引导扇区（512B）加载到 0x7c00
- 跳转到 CS:IP = 0000:7c00

加载程序

- 将操作系统代码、数据从硬盘加载入内存
- 跳转到操作系统起始地址

BIOS 的基本中断

```
int 10h
int 13h
int 15h
int 16h
```

# 启动流程

```
BIOS -> 主引导记录 -> 活动分区引导扇区 -> 加载程序
```

CS:IP = 0xf000:fff0

jmp

16实模式

PC = 16*CS+IP

max 1MB(20 addr)

## BIOS init

- 硬件自检 POST

## MBR 格式

启动代码：446 字节

- 检查分区表正确性
- 加载并跳转到磁盘上的引导程序

硬盘分区表：64 字节

结束标志字：2字节（55AA）

## 分区引导扇区格式

## 加载程序（bootloader）

- 从文件系统中读取启动配置信息

- 启动菜单：参数
- 加载内核

## 系统启动规范

- BIOS
  - BIOS-MBR、BIOS-GPT、PXE(网络启动标准)

- UEFI
  - 接口标准
  - 在所有平台上一致的操作系统服务

# 中断异常和系统调用

## 背景

- 方便应用程序
- 只有内核可以执行特权指令

### 中断、异常解决的问题

- 外设与计算机的连接（中断）
- 处理应用程序意想不到的行为

### 系统调用解决的问题

- 应用程序得到系统服务
- 系统调用和功能调用的不同

## 内核的进入和退出

